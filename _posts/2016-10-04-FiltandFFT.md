---
slideinit: "<section markdown=\"1\" data-background=\"http://matin-hub.github.io/project-pages/img/slidebackground.png\"><section markdown=\"1\">"
vertical: "</section><section markdown=\"1\">"
horizontal: "</section></section><section markdown=\"1\" data-background=\"http://matin-hub.github.io/project-pages/img/slidebackground.png\"><section markdown=\"1\">"
subtitle: ""
layout: post
author: Ahmet Cecen
tags: class materials-informatics
theme: beige
trans: cube
visualworkflow: false
published: true
title: Filtering and Fourier Transform
category: class
date: 2016-10-04 10:50
---

<h1>Fourier Space Filtering</h1>

Filtering in real space can be represented by the following relationship:

$$ Filtered Image = Cx $$

Where $x$ is the filter, and $C$ is a circulant matrix constructed using the input image. For a simple example let us assume the input image and filter are 1D. The matrix $C$ is constructed by shifting the image periodically once at each row. Notice below the 1D image starts with the green pixel and ends with the red, and repeatedly shifted to produce the matrix $C$. The vectors corresponding to these shifts are illustrated to the left. Convince yourself the multiplication in the image below is equivalent to filtering of the 1D image at the first row of the matrix with the yellow filter.

![Circulant.png]({{site.baseurl}}/img/tutorial-resources/Circulant.png)

<p>Any circulant matrix 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAB3RJTUUH4AkFDxYOECL8jAAAARZJREFUGJVdj6HKwmAYhc+3sGTbFwxDQVgVvAZlZRexO7CbvQiLRRBBEIsLgoZhNG1piLi2lYGKA8PYvvOHj1/Ep56X55xXkARAUghRluXhcLher61Wy3Vdx3HW67XQFwCWy+V+v/c8bzAYADidTnEc53kOpRTJyWQyHA6LouAX3W53u92C5Hw+l1JmWUayaRqlVNM0JMfj8e12w+PxkFJOp1MdfzvCMKzrGovFAkCSJCR14w/G8XjsdDq2bQMQQuCf5/P5er0AGO122zAM0zT1zxoAQRBUVQXA8H2/LMvL5aIdmjAMLcuSUpIEydls5rru+Xy+3+9pmm42m91u9/EJpZQQIoqi1Wr1fr/7/f5oNOr1ep9Bf90d1kLOf/GaAAAAAElFTkSuQmCC" style="display:inline" />

 can be diagonalized by the Fourier matrix F as:</p>
<p>


<img src="data:image/png;base64,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" />


</p>

Read [DFT Matrix](https://en.wikipedia.org/wiki/DFT_matrix) and [convolution theorem](https://en.wikipedia.org/wiki/Convolution_theorem) from Wikipedia if you are interested in understanding why this is so.

<p>This fact can be exploited to achieve multiplication of a vector with 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAB3RJTUUH4AkFDxYOECL8jAAAARZJREFUGJVdj6HKwmAYhc+3sGTbFwxDQVgVvAZlZRexO7CbvQiLRRBBEIsLgoZhNG1piLi2lYGKA8PYvvOHj1/Ep56X55xXkARAUghRluXhcLher61Wy3Vdx3HW67XQFwCWy+V+v/c8bzAYADidTnEc53kOpRTJyWQyHA6LouAX3W53u92C5Hw+l1JmWUayaRqlVNM0JMfj8e12w+PxkFJOp1MdfzvCMKzrGovFAkCSJCR14w/G8XjsdDq2bQMQQuCf5/P5er0AGO122zAM0zT1zxoAQRBUVQXA8H2/LMvL5aIdmjAMLcuSUpIEydls5rru+Xy+3+9pmm42m91u9/EJpZQQIoqi1Wr1fr/7/f5oNOr1ep9Bf90d1kLOf/GaAAAAAElFTkSuQmCC" style="display:inline" />

 in O(nlogn) time using FFT. The following scheme can be used for this purpose, where 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAHCAIAAACk8qu6AAAAB3RJTUUH4AkFDxYQ6i3B7wAAAIVJREFUCJkFwbENgCAQBdA7QscExAUcwMSOTXQKJ4DKYawIla21FDROYAKVBaHT73v8fR8ze++P49Baz/Msmdk5J6Vc13WaJiKifd/HcWytAQgh3PdNxphlWQC87wsAgHyep+97IhJC1FpLKcJaG2PMOaeUtm0jIgZwnud1XV3XDcOglPoBckdFu8AujcsAAAAASUVORK5CYII=" style="display:inline" />

 is the first column 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAB3RJTUUH4AkFDxYOECL8jAAAARZJREFUGJVdj6HKwmAYhc+3sGTbFwxDQVgVvAZlZRexO7CbvQiLRRBBEIsLgoZhNG1piLi2lYGKA8PYvvOHj1/Ep56X55xXkARAUghRluXhcLher61Wy3Vdx3HW67XQFwCWy+V+v/c8bzAYADidTnEc53kOpRTJyWQyHA6LouAX3W53u92C5Hw+l1JmWUayaRqlVNM0JMfj8e12w+PxkFJOp1MdfzvCMKzrGovFAkCSJCR14w/G8XjsdDq2bQMQQuCf5/P5er0AGO122zAM0zT1zxoAQRBUVQXA8H2/LMvL5aIdmjAMLcuSUpIEydls5rru+Xy+3+9pmm42m91u9/EJpZQQIoqi1Wr1fr/7/f5oNOr1ep9Bf90d1kLOf/GaAAAAAElFTkSuQmCC" style="display:inline" />

 and 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAALCAIAAADN+VtyAAAAB3RJTUUH4AkFDxYQ6i3B7wAAAM1JREFUGJVFjUHKR2AYxJ+XO9hYikIpp+AOlsopXMHWSlm7gWRnpawUZckBlI0k7zPfwj/f7Gaa+Y1gZiHEOI5SSt/36RMzA1iWxTCMuq4BvAkBkFICSNM0CILP0leZ51nTtG3b3kQhIiEEANu2LcuqqoqIfgsAz/MAyLLMdd3/BTOrqjpN03Ec+773fS+EoPdqGIY4jq/riqIoSZIfquu6MAzXdQXQtq2u6+d5UtM0nudN0/SipZSmaeZ5rgAoisJxHGYmIkVRyrK87/sPTJawNmaHu0IAAAAASUVORK5CYII=" style="display:inline" />

 is a vector containing the main diagonal of 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALCAIAAADJDItPAAAAB3RJTUUH4AkFDxYRnSrxeQAAAOdJREFUGJVNjjHLQFAUht97fTsWk8FAmZRdJt3d3/JfZLEpZScGkc1iYFASFrnfcOX7znaet/c5h3DOAXDOCSF5nt/3zRgTK4Af/JskSc7zZIx95I0JIcdxNE2zruu2bbIsC06FGcAwDEEQ7PteluUH6efp+z4MQ13X8zz/IBXm67rWdXUcx/f9LMvu+xavve1xHFVVBcAYG8ex6zrhp+JG27a2bQNwXVeW5aIo/uQAlmUxTROAqqqe56Vp+rYJIX3fz/OsKMrzPMJf1/U0TZRSVFWlaZokSVEUcc7TNLUsC4BhGHEc/wKP1XkmNgQokgAAAABJRU5ErkJggg==" style="display:inline" />

:</p>
<p>


<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAPCAIAAAAaghScAAAAB3RJTUUH4AkFDxYSBCOgwwAABWVJREFUSIndVl9IU20Yf99zTo5tNbUacmBKC9dS7O8gEIn0YhmpBHnhLiKlmxhetFZXSYnJgtmFSrC6Kug/knmRB71RcBKCggQTm+Q/SmnsRJs7p3n+ed7v4qXDYVOb39f3Ed/v6n3f87zv8/s9z8NzHoB+YmBggGVZhJCqqqqq4kO8EATh1atXkiSh/x0ohBCE8OnTp1ardf/+/XgLAFheXo7H46dOnUIIGQwGu90eCoWuXbsG/jBgwt3d3RMTE2trawAAq9VKUZQsy7FYzGAwhEKhAwcOaLo2uT89Pd3W1oZ+ZjsSiTx69Kiqqsrr9SJdOQSDwaGhIc0sd6g66E9+Vw4RQvF4nGEYgiCMRuPIyMji4mI0Gu3v78/Pzx8ZGUEIbWxsZBNQVZUAADx//ry2tlaLiM1mu3z58qFDhzIideHChTdv3gAANg/k1oA6IIS0k18mdhtkWFqtVqfTaTKZzGazw+Gw2+0Oh+PixYs+n292dhYAQBCE3qnGh4rFYsvLyydPntSEFRQU4LXmBq+dTifP8zMzMxUVFWircsqCoigMw3z//h1C6HQ6Kysr5+fnw+FwXl5eXV1dYWGh3pjjOJZlDx48CHYeZVmWcXp37dqlKMqNGzeCwWBDQ8PCwsLKysrw8DBFUWazua6ubnV1dXx8HCHkcrmoT58+4Q+aJFVVCYLY1MfevXs/fvxYUVGROy2E0Pr6emdn59LSUl9fHwBAEISurq6mpqYMMwjhs2fPQqHQ2NjYvn37wuFwMpnMYAIhVBSlpKTkxIkT2b4ghKIoMgyztLQ0NjYmy7LL5XK5XHNzc1+/fg0Gg4WFhfX19ZFI5M6dO16vVxRFKhaL7dmzJ+OVrcTYbLbPnz/nLh4AQFGUx+ORJKm5uTmZTAIAUqmU2+3u6OjIdnr27NmioqL8/HwcNY7jSJLUVzvWL4ripr4ghKqqfvv2bWVlRVVVTYjT6bx9+7bD4bhy5crdu3dTqdSTJ0/cbjcAgGJZlqKoHMXk5eXJsrwj/ZhEY2PjvXv3urq6mpubX7582djYCH7mXG9cWlpaWlqK1/qWlCNUVTUajS0tLRaL5erVq4qi4HPcMjwez+LiYltbW2trq9vtxgGibDbb1NSU/hVMiyAIXHt6lj9+/MDdYUdACJnNZp/P5/V6fT4fSZI1NTVg20KTZbm/v59l2ez8y7J8+PDh2trajPBpHU4QhKKiokAgoNU1PlcUJZFIVFdXv3jxor6+/ty5cwAAiqZpnuf1vrFsnucNBoO2xfjy5QvulH8DHo+np6fn4cOH4XAYZCUfb0dHRxmG6ezsNJlMZ86ckSQp4xFc4bt37wa68OGgJJNJSZIIglhbWxMEobi4WLslSRLHce3t7TRNj46Onj9/3uPxDA0NHTt2jCorKyNJkmVZq9WKSUQiEYZhcOxxCy0vL4cQbmxspFKpI0eO7FS59lu5dOlSOBw+ffo02CL58Xh8ZmYG1y1N07k8jjk/fvz4/fv35eXlBEH09vba7Xa/328ymfDXycnJBw8ezM7O3r9/H0JYXV0djUYDgYDD4QAIoUAgMDAwgIcEhJAoiolEYn19PZ1OJxIJURTxf2ViYuL69eto5/PP69evh4eHEUJ+v39wcHD7FzCHnSKdTnMcJwiCIAgcx/E8r3chSRLP84Ig4BFeEARRFNPpdCqVAgih1dVVv9//y/H+1q1bHz582J59NiRJstvtVVVV7969a21t/b1j3z8H2d7ebrFYjEbj+Pj48ePHtyqwt2/f0jRdU1ODcp588F2SJMvKykRRhBDevHkT95Q/BxCHAUI4NzdH07TFYsk2kiQpGo0ePXr0v+f3b+Mvwcv9aTHkJbUAAAAASUVORK5CYII=" />


</p>
<p>


<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAAAPCAIAAAAXnGTbAAAAB3RJTUUH4AkFDxYSBCOgwwAABVVJREFUSInVVk1ME1sUPneYtgEKCGlTSgqFBCQIaoQFRDdGY92hCSzcaTXRSGJMuwMXmpgmdGFUQqYLwk80gn8tCzNBUQQJhkSDEYKhBUIRITZtMZRp7UynM9fFfTR9FnzA+/8Wk/m55zvnO+fMvQfwBvr7+wOBAMZYlmX8e/A839fXF4vF8J9AKu2/CxpjjBC6d++eVqvVaDTk8d27d7OzszRNm0ymvLw8lUpVUlLCMMzVq1dh5yCcLMs6nc7W1ladTrcLkl8w3759e3x8PBQKAYBWq6VpWhRFn8+nUqkYhikuLibLNjH+8OHDtWvX8EZZXC7X06dPPR6P3W6vqanxeDwkSXa7fWBgAO+qesTk+PHjxJEkSX9J3Qj8fj/LshRFpaenDw0NLSwsuN1up9OZk5MzNDSU8C4nAWMMGGOr1To6OkpYgsFgbW0tMcAY19XVnTlzhty73e4LFy7sLjji7NGjR1VVVYIgbNNkK6Qyz8/Pq9VqjUaztLSENzJ7/fr19vZ2vEWiKZ/Pt7i4WF1dTVpAqVTq9fqlpSXyWFxc/PnzZwCQZbm8vDwcDk9PT5NO2VFbkmY7ceJENBodGRnZlIHjuIWFhWSTrZDKL4oiSYFCoYjH4xaLhef5+vr63NxcAKAoShTF58+fd3Z29vT0vHjxQhAEem5ujqbpzMxMjDFCKCsr6+HDh0qlEgAEQZiYmLh48WIi0Ly8vJmZmaqqqh3JJpBlOTc39+TJkw8ePDCZTMmfiOv79+8zDDMyMqLRaJaXlycmJmiaTk0QRVFHjhzJyclJTa4gCCzLer3eN2/eiKJYXV198OBBAIhEIufPn/d6va2trWNjY2azmWEY2ufzZWVlJVOoVCri79atW4cOHbpy5QpsFM1gMCTaYaegKAoACgoKHA5HMBhM7KYJcpPJpNPp9uzZAwCSJHEct6nytLS0TTsOISTLcjAYXF5elmWZcBKnPT09jx8/7uvrO3bsmMFgmJqaKisrowOBAE3TyRQkIKfTGQqFOjs7SSIIkVKpFEVxd8oBgGEYo9GYn5//7Nkzs9n809fS0tLS0lISgNFoNBqNOyKXZTk9Pf3cuXPZ2dmXLl2Kx+MJLcPDwwBQVFQEAHv37n3y5AlCiDYYDO/fv/9J9tjY2Pr6ut1uB4DBwUGTyUTSHIlESE12AZvNplAompqaFhcXe3t7U5UngBCamZkZHBxUKBSbdntjY6NWq/3pJdkCeJ7X6XQ2m400MimYRqMBAEEQEgJXV1dpvV4fDoeTZb969aq3t/f06dMsywYCAb/fT5QjhL58+ZLYC7ePeDze3NwsiuKdO3cAoKGhweFwfPr0qbKyktCS6+vXr1mWvXnzZkZGRmFh4alTpyiKSlWOEEr+yRFCoiiura3FYjGKokKhEM/zhYWFySZms7m7u7ujo+Pw4cMqlcrlck1OTtIVFRVpaWmBQIBkkeM4h8MxOzs7OTmJMY5EIjdu3CAOJElaX1/fv3//9jUTSS6X6+vXr11dXeRNRUXF0aNHX758WVlZmbzY7/dPT0+TLlWr1Wq1epv8XV1db9++3bdvH0VRd+/eLSkpsVqtGRkZsFHz2tragYGBtrY2i8VSUFAAAJcvXwaMsc1m6+/vJ2ejJEnRaJRPgiRJ5MAYHx+3WCx455PM2tpaNBpNNuQ4bmVlJXXl7iac79+/cxxHouU4LhwObxXht2/fVldXyT1gjFdWVqxW6x+O5S0tLR8/fsT/vQl8O0iNGZEDYHR01Ov1nj179hcdizFuaGjAm87A/0Og3xKAkMfj0ev12dnZqYtisZjb7T5w4MA/H9/fhx8F3Kn7D+dSxgAAAABJRU5ErkJggg==" />


</p>
<p>


<img src="data:image/png;base64,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" />


</p>
<p>where 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAB3RJTUUH4AkFDxYU7UAF9gAAAKFJREFUCJklxyEaQDAYBuBv41EENxBEh1AcQ9LXXMYVdEfQlvDsAAKqMkv7P8HbXkUSAADvPYA8z/9qkjFGAPM8O+cAiAgArZRKkgTAuq4hBABaawDpNE3W2qqqrLXv+y7L4r3vug4kj+MYhgFAlmXjOD7PQzKNMZZlWdd127YhhKZpiqIQEZC877vvexHZ990YQ5IkSG7bdl3Xf+fceZ4kP/44bQ0VKP+HAAAAAElFTkSuQmCC" style="display:inline" />

 is element-wise multiplication. Notice the above algortihm is actually the Convolution Theorem in disguise, where 

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAALCAIAAADEEvsIAAAAB3RJTUUH4AkFDxYU7UAF9gAAARtJREFUGJVtjkGqgmAURu8vgiAJTURIGjpoGg6aiDgKXEKESGtwB21AF9AWhKCRQULQsC00cBJEE4mfEvR+b+B78Xi9M7lc+DgcAYB+OB6PaZpWVdU0DQAAiqJMp1PxHmVZ1rbteDxOkmS9XjuOQ0S73W4wGBAzA9hut4vFAsDpdJrNZlJK/EIVQhCR67q+7xNRWZaTyUTX9V7PzESk9s9oNCKiruvO57PneVLK5/OpqupwOCSi7yYAQojL5TKfz23bNgzj8XhEUbRarQAQAGbuy7Isi+NYSlnX9f1+77qub6L+MPPr9QrDcL/f4wOFma/XqxCiKApN04IgoE82m41pmnmeL5fLsix76x8T3W43z/MsyzocDv8uAHwBmbvoCpqatf0AAAAASUVORK5CYII=" style="display:inline" />

 is the Fourier Transform operator:</p>
<p>


<img src="data:image/png;base64,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" />


</p>
<p>The mirror mismatch between convolution and correlation operations can be accounted for by conjugation of the filter in Fourier space.</p>
